**思路：**

一次遍历，从前往后枚举区间终点，同时用一个数组记录当前不同前缀和的数量，用 `f[i]` 代表和为 `i` 的前缀和个数。假设枚举的当前坐标是 `j`，那么我们的目标就是计算`j`之前共有多少个前缀和是 `sum[j] - S`，这个值就是 `f[sum[j] - S]`。由于遍历过程中，每个前缀和 `sum[j]` 只用了一次，所以我们可以用一个变量 `s` 来表示，减少空间复杂度。

时间复杂度 $O(N)$

空间复杂度 $O(N)$

